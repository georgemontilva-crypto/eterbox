{
  "query": "-- Admin Permissions Table\nCREATE TABLE IF NOT EXISTS admin_permissions (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL UNIQUE REFERENCES users(id) ON DELETE CASCADE,\n  is_super_admin BOOLEAN DEFAULT FALSE,\n  can_view_users BOOLEAN DEFAULT TRUE,\n  can_edit_users BOOLEAN DEFAULT FALSE,\n  can_delete_users BOOLEAN DEFAULT FALSE,\n  can_send_bulk_emails BOOLEAN DEFAULT FALSE,\n  can_view_revenue BOOLEAN DEFAULT FALSE,\n  can_manage_admins BOOLEAN DEFAULT FALSE,\n  can_view_analytics BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  created_by INTEGER REFERENCES users(id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_admin_permissions_user_id ON admin_permissions(user_id);\nCREATE INDEX IF NOT EXISTS idx_admin_permissions_super_admin ON admin_permissions(is_super_admin);\n\n-- Analytics Cache Table (for performance)\nCREATE TABLE IF NOT EXISTS analytics_cache (\n  id SERIAL PRIMARY KEY,\n  metric_name VARCHAR(100) NOT NULL,\n  metric_value JSONB NOT NULL,\n  period VARCHAR(20) NOT NULL,\n  cached_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_analytics_cache_metric ON analytics_cache(metric_name, period);\nCREATE INDEX IF NOT EXISTS idx_analytics_cache_time ON analytics_cache(cached_at DESC);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway03.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2qLUrtGoNx4qi5k.feaf103e2c6e --database KVPx8dhkiRjBe7rJpxWYcJ --execute -- Admin Permissions Table\nCREATE TABLE IF NOT EXISTS admin_permissions (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL UNIQUE REFERENCES users(id) ON DELETE CASCADE,\n  is_super_admin BOOLEAN DEFAULT FALSE,\n  can_view_users BOOLEAN DEFAULT TRUE,\n  can_edit_users BOOLEAN DEFAULT FALSE,\n  can_delete_users BOOLEAN DEFAULT FALSE,\n  can_send_bulk_emails BOOLEAN DEFAULT FALSE,\n  can_view_revenue BOOLEAN DEFAULT FALSE,\n  can_manage_admins BOOLEAN DEFAULT FALSE,\n  can_view_analytics BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  created_by INTEGER REFERENCES users(id)\n);\n\nCREATE INDEX IF NOT EXISTS idx_admin_permissions_user_id ON admin_permissions(user_id);\nCREATE INDEX IF NOT EXISTS idx_admin_permissions_super_admin ON admin_permissions(is_super_admin);\n\n-- Analytics Cache Table (for performance)\nCREATE TABLE IF NOT EXISTS analytics_cache (\n  id SERIAL PRIMARY KEY,\n  metric_name VARCHAR(100) NOT NULL,\n  metric_value JSONB NOT NULL,\n  period VARCHAR(20) NOT NULL,\n  cached_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_analytics_cache_metric ON analytics_cache(metric_name, period);\nCREATE INDEX IF NOT EXISTS idx_analytics_cache_time ON analytics_cache(cached_at DESC);",
  "returncode": 1,
  "logs": [
    "ERROR 1064 (42000) at line 22: You have an error in your SQL syntax; check the manual that corresponds to your TiDB version for the right syntax to use line 4 column 21 near \"JSONB NOT NULL,",
    "  period VARCHAR(20) NOT NULL,",
    "  cached_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
    ")\""
  ]
}