{
  "query": "-- Push Notification Subscriptions Table\nCREATE TABLE IF NOT EXISTS push_subscriptions (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n  endpoint TEXT NOT NULL UNIQUE,\n  p256dh TEXT NOT NULL,\n  auth TEXT NOT NULL,\n  device_info JSONB DEFAULT '{}',\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  last_used_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_push_subscriptions_user_id ON push_subscriptions(user_id);\nCREATE INDEX IF NOT EXISTS idx_push_subscriptions_endpoint ON push_subscriptions(endpoint);\n\n-- Notification Preferences Table\nCREATE TABLE IF NOT EXISTS notification_preferences (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL UNIQUE REFERENCES users(id) ON DELETE CASCADE,\n  security_alerts BOOLEAN DEFAULT TRUE,\n  marketing_promos BOOLEAN DEFAULT TRUE,\n  product_updates BOOLEAN DEFAULT TRUE,\n  account_activity BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_notification_preferences_user_id ON notification_preferences(user_id);\n\n-- Notification History Table\nCREATE TABLE IF NOT EXISTS notification_history (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n  type VARCHAR(50) NOT NULL,\n  title VARCHAR(255) NOT NULL,\n  body TEXT NOT NULL,\n  data JSONB DEFAULT '{}',\n  sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  read_at TIMESTAMP,\n  clicked_at TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_notification_history_user_id ON notification_history(user_id);\nCREATE INDEX IF NOT EXISTS idx_notification_history_sent_at ON notification_history(sent_at DESC);\nCREATE INDEX IF NOT EXISTS idx_notification_history_type ON notification_history(type);",
  "command": "mysql --batch --raw --column-names --default-character-set=utf8mb4 --host gateway03.us-east-1.prod.aws.tidbcloud.com --port 4000 --user 2qLUrtGoNx4qi5k.feaf103e2c6e --database KVPx8dhkiRjBe7rJpxWYcJ --execute -- Push Notification Subscriptions Table\nCREATE TABLE IF NOT EXISTS push_subscriptions (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n  endpoint TEXT NOT NULL UNIQUE,\n  p256dh TEXT NOT NULL,\n  auth TEXT NOT NULL,\n  device_info JSONB DEFAULT '{}',\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  last_used_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_push_subscriptions_user_id ON push_subscriptions(user_id);\nCREATE INDEX IF NOT EXISTS idx_push_subscriptions_endpoint ON push_subscriptions(endpoint);\n\n-- Notification Preferences Table\nCREATE TABLE IF NOT EXISTS notification_preferences (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL UNIQUE REFERENCES users(id) ON DELETE CASCADE,\n  security_alerts BOOLEAN DEFAULT TRUE,\n  marketing_promos BOOLEAN DEFAULT TRUE,\n  product_updates BOOLEAN DEFAULT TRUE,\n  account_activity BOOLEAN DEFAULT TRUE,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_notification_preferences_user_id ON notification_preferences(user_id);\n\n-- Notification History Table\nCREATE TABLE IF NOT EXISTS notification_history (\n  id SERIAL PRIMARY KEY,\n  user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,\n  type VARCHAR(50) NOT NULL,\n  title VARCHAR(255) NOT NULL,\n  body TEXT NOT NULL,\n  data JSONB DEFAULT '{}',\n  sent_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  read_at TIMESTAMP,\n  clicked_at TIMESTAMP\n);\n\nCREATE INDEX IF NOT EXISTS idx_notification_history_user_id ON notification_history(user_id);\nCREATE INDEX IF NOT EXISTS idx_notification_history_sent_at ON notification_history(sent_at DESC);\nCREATE INDEX IF NOT EXISTS idx_notification_history_type ON notification_history(type);",
  "returncode": 1,
  "logs": [
    "ERROR 1064 (42000) at line 2: You have an error in your SQL syntax; check the manual that corresponds to your TiDB version for the right syntax to use line 7 column 20 near \"JSONB DEFAULT '{}',",
    "  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,",
    "  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,",
    "  last_used_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP",
    ")\""
  ]
}